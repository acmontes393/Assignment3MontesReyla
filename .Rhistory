plot(WDI_indi$NY.GDP.PCAP.KD.ZG, WDI_indi$"1.0.HCount.1.25usd", xlab = "GDP per capita growth", ylab= "Head count 1.25 us")
ggplot2::ggplot(WDI_indi, aes (NY.GDP.PCAP.KD.ZG, "1.0.HCount.1.25usd"), , xlab = "GDP per capita growth", ylab= "Head count 1.25 us") + geom_point() + geom_smooth() + theme_bw()
plot(WDI_indi$NY.GDP.PCAP.KD.ZG, WDI_indi$"1.0.HCount.1.25usd", xlab = "GDP per capita growth", ylab= "Head count 1.25 us")
ggplot2::ggplot(WDI_indi, aes(NY.GDP.PCAP.KD.ZG, "1.0.HCount.1.25usd")) + geom_point() + geom_smooth() + theme_bw()
knitr::opts_chunk$set(echo = FALSE)
library(WDI)
library(RJSONIO)
library(ggplot2)
WDI_indi<- WDI(country = c("AR","BR","BZ", "CL", "CO", "EC", "SV", "GT", "HN",
"LA", "MX", "NI", "PA", "PR", "PE", "UY","VE"),
indicator = c("NY.GDP.PCAP.KD.ZG", "1.0.HCount.1.25usd",
"1.0.HCount.2.5usd", "1.0.HCount.Poor4uds",
"1.0.HCount.10usd"),
start = 1990, end = 2013, extra = FALSE, cache = NULL)
write.table(WDI_indi, file = "WDI_indi", append = FALSE, quote = TRUE, sep = , ,
eol = "\n", na = "NA", dec = ".", row.names = TRUE,
col.names = TRUE, qmethod = c("escape", "double"),
fileEncoding = "")
WDI_indi$1.0.HCount.1.25usd <-Geadcount.1.25
plot(WDI_indi$NY.GDP.PCAP.KD.ZG, WDI_indi$"1.0.HCount.1.25usd", xlab = "GDP per capita growth", ylab= "Head count 1.25 us")
ggplot2::ggplot(WDI_indi, aes(NY.GDP.PCAP.KD.ZG, "1.0.HCount.1.25usd")) + geom_point() + geom_smooth() + theme_bw()
plot(WDI_indi$NY.GDP.PCAP.KD.ZG, WDI_indi$"1.0.HCount.1.25usd", xlab = "GDP per capita growth", ylab= "Head count 1.25 us")
ggplot2::ggplot(WDI_indi, aes(NY.GDP.PCAP.KD.ZG, "1.0.HCount.1.25usd")) + geom_point() + geom_smooth(x) + theme_bw()
plot(WDI_indi$NY.GDP.PCAP.KD.ZG, WDI_indi$"1.0.HCount.1.25usd", xlab = "GDP per capita growth", ylab= "Head count 1.25 us")
ggplot2::ggplot(WDI_indi, aes(NY.GDP.PCAP.KD.ZG, "1.0.HCount.1.25usd")) + geom_point() + theme_bw()
plot(WDI_indi$NY.GDP.PCAP.KD.ZG, WDI_indi$"1.0.HCount.1.25usd", xlab = "GDP per capita growth", ylab= "Head count 1.25 us")
ggplot2::ggplot(WDI_indi, aes(NY.GDP.PCAP.KD.ZG, "1.0.HCount.1.25usd")) + geom_point() + geom_smooth(x) + theme_bw()
?ggplot2
?ggplot
plot(WDI_indi$NY.GDP.PCAP.KD.ZG, WDI_indi$"1.0.HCount.1.25usd", xlab = "GDP per abline(lm(NY.GDP.PCAP.KD.ZG~"1.0.HCount.1.25usd"), col="red")
plot(WDI_indi$NY.GDP.PCAP.KD.ZG, WDI_indi$"1.0.HCount.1.25usd", xlab = "GDP per abline(lm(NY.GDP.PCAP.KD.ZG~1.0.HCount.1.25usd), col="red")
install.packages(countrycode)
install.packages(countrycode)
install.packages('countrycode')
library(countrycode)
library(countrycode)
?countrycode
View(WDI_indi)
View(WDI_indi)
?is.na
# 2. Loading the default data for the years 2000-2012 from the Worldbank database
wbdata <- c('NY.GDP.MKTP.KD', 'NY.GDP.PCAP.PP.KD', 'SI.POV.GAPS', 'SP.RUR.TOTL.ZS',
'EN.ATM.CO2E.PC', 'EG.ELC.ACCS.ZS', 'SH.XPD.TOTL.ZS', 'SH.H2O.SAFE.ZS',
'SH.STA.ACSN', 'SL.UEM.TOTL.ZS','SL.TLF.0714.WK.ZS', 'SE.PRM.ENRR', 'SH.XPD.PCAP',
'SL.UEM.TOTL.FE.ZS', 'SE.PRM.ENRR.FE', 'SP.HOU.FEMA.ZS', 'SP.DYN.LE00.IN',
'SI.POV.GINI', 'SH.CON.1524.FE.ZS', 'SH.CON.1524.MA.ZS', 'SP.DYN.CONU.ZS',
'SH.IMM.IDPT', 'SH.IMM.MEAS', 'SH.STA.OWGH.ZS', 'SH.PRV.SMOK.FE',
'SH.PRV.SMOK.MA', 'SP.POP.TOTL','SH.MED.BEDS.ZS','SH.STA.BRTC.ZS')
dataset <- WDI(country='all', indicator=wbdata, start=2000, end=2012, extra=TRUE)
# 3. Cleaning the data
## Dropping regional data
dataset <- dataset[dataset$region != "Aggregates", ]
# Dropping rows where all variables are missing
dataset2 <- dataset[which(rowSums(!is.na(dataset[, wbdata])) > 0), ]
# Visualising and counting deleted values
rows.in.a1.that.are.not.in.a2  <- function(dataset,dataset2)
{
dataset.vec <- apply(dataset, 1, paste, collapse = "")
dataset2.vec <- apply(dataset2, 1, paste, collapse = "")
a1.without.a2.rows <- dataset[!dataset.vec %in% dataset2.vec,]
return(a1.without.a2.rows)
}
AllNAs <- rows.in.a1.that.are.not.in.a2(dataset,dataset2)
nrow(AllNAs)
dataset <- dataset2
# Dropping rows where information on variable iso2c is missing
dataset <- dataset[!is.na(dataset$iso2c),] ## No observations were dropped ###
## Ordering the dataset and the years (ascending)
dataset <- group_by(dataset, iso2c)
dataset <- arrange(dataset, iso2c, year)
## Renaming all the variables with simple names
dataset <- plyr::rename(dataset, c("NY.GDP.MKTP.KD" = "GDP"))
dataset <- plyr::rename(dataset, c("NY.GDP.PCAP.PP.KD" = "GDPpc"))
dataset <- plyr::rename(dataset, c("SI.POV.GAPS" = "Poverty"))
dataset <- plyr::rename(dataset, c("SP.RUR.TOTL.ZS" = "Rural"))
dataset <- plyr::rename(dataset, c("EN.ATM.CO2E.PC" = "CO2"))
dataset <- plyr::rename(dataset, c("EG.ELC.ACCS.ZS" = "Electr"))
dataset <- plyr::rename(dataset, c("SH.XPD.TOTL.ZS" = "HCexpend"))
dataset <- plyr::rename(dataset, c("SH.XPD.PCAP" = "HCexpendpc"))
dataset <- plyr::rename(dataset, c("SH.STA.BRTC.ZS" = "Births"))
dataset <- plyr::rename(dataset, c("SH.MED.BEDS.ZS" = "HospBeds"))
dataset <- plyr::rename(dataset, c("SH.H2O.SAFE.ZS" = "Water"))
dataset <- plyr::rename(dataset, c("SH.STA.ACSN" = "Sanitation"))
dataset <- plyr::rename(dataset, c("SL.UEM.TOTL.ZS" = "Unemploym"))
dataset <- plyr::rename(dataset, c("SL.TLF.0714.WK.ZS" = "Childempl"))
dataset <- plyr::rename(dataset, c("SE.PRM.ENRR" = "Primary"))
dataset <- plyr::rename(dataset, c("SL.UEM.TOTL.FE.ZS" = "FemUnempl"))
dataset <- plyr::rename(dataset, c("SE.PRM.ENRR.FE" = "FemSchool"))
dataset <- plyr::rename(dataset, c("SP.HOU.FEMA.ZS" = "FemHead"))
dataset <- plyr::rename(dataset, c("SP.DYN.LE00.IN" = "LifeExpect"))
dataset <- plyr::rename(dataset, c("SI.POV.GINI" = "GINI"))
dataset <- plyr::rename(dataset, c("SH.CON.1524.FE.ZS" = "CondFem"))
dataset <- plyr::rename(dataset, c("SH.CON.1524.MA.ZS" = "CondMale"))
dataset <- plyr::rename(dataset, c("SP.DYN.CONU.ZS" = "Contraceptive"))
dataset <- plyr::rename(dataset, c("SH.IMM.IDPT" = "DPT"))
dataset <- plyr::rename(dataset, c("SH.IMM.MEAS" = "Measles"))
dataset <- plyr::rename(dataset, c("SH.STA.OWGH.ZS" = "Overweight"))
dataset <- plyr::rename(dataset, c("SH.PRV.SMOK.FE" = "SmokeFem"))
dataset <- plyr::rename(dataset, c("SH.PRV.SMOK.MA" = "SmokeMale"))
dataset <- plyr::rename(dataset, c("SP.POP.TOTL" = "Population"))
## Counting NAs in the independent variables
AllNAs$GDPsum <- sum(is.na(dataset$GDP))/nrow(dataset)
AllNAs$GDPpcsum <- sum(is.na(dataset$GDPpc))/nrow(dataset)
AllNAs$Povertysum <- sum(is.na(dataset$Poverty))/nrow(dataset)
AllNAs$Ruralsum <- sum(is.na(dataset$Rural))/nrow(dataset)
AllNAs$CO2sum <- sum(is.na(dataset$CO2))/nrow(dataset)
AllNAs$Electrsum <- sum(is.na(dataset$Electr))/nrow(dataset)
AllNAs$HCexpendsum <- sum(is.na(dataset$HCexpend))/nrow(dataset)
AllNAs$HCexpendpcsum <- sum(is.na(dataset$HCexpendpc))/nrow(dataset)
AllNAs$Birthssum <- sum(is.na(dataset$Births))/nrow(dataset)
AllNAs$Watersum <- sum(is.na(dataset$Water))/nrow(dataset)
AllNAs$Sanitationsum <- sum(is.na(dataset$Sanitation))/nrow(dataset)
AllNAs$Unemploymsum <- sum(is.na(dataset$Unemploym))/nrow(dataset)
AllNAs$Childemplsum <- sum(is.na(dataset$Childempl))/nrow(dataset)
AllNAs$Primarysum <- sum(is.na(dataset$Primary))/nrow(dataset)
AllNAs$FemUnemplsum <- sum(is.na(dataset$FemUnempl))/nrow(dataset)
AllNAs$FemSchoolsum <- sum(is.na(dataset$FemSchool))/nrow(dataset)
AllNAs$FemHeadsum <- sum(is.na(dataset$FemHead))/nrow(dataset)
AllNAs$LifeExpectsum <- sum(is.na(dataset$LifeExpect))/nrow(dataset)
AllNAs$GINIsum <- sum(is.na(dataset$GINI))/nrow(dataset)
AllNAs$CondFemPsum <- sum(is.na(dataset$CondFem))/nrow(dataset)
AllNAs$CondMalesum <- sum(is.na(dataset$CondMale))/nrow(dataset)
AllNAs$Contraceptivesum <- sum(is.na(dataset$Contraceptive))/nrow(dataset)
AllNAs$DPTsum <- sum(is.na(dataset$DPT))/nrow(dataset)
AllNAs$Measlessum <- sum(is.na(dataset$Measles))/nrow(dataset)
AllNAs$Overweightsum <- sum(is.na(dataset$Overweight))/nrow(dataset)
AllNAs$SmokeFemsum <- sum(is.na(dataset$SmokeFem))/nrow(dataset)
AllNAs$SmokeMalesum <- sum(is.na(dataset$SmokeMale))/nrow(dataset)
AllNAs$HospBedssum <- sum(is.na(dataset$HospBeds))/nrow(dataset)
# 1. Loading Required Packages
# install.packages("RJOSONIO")
library(RJSONIO)
# install.packages("WDI")
library(WDI)
# install.packages("dplyr")
library(dplyr)
# install.packages("tidyr")
library(tidyr)
# install.packages("httr")
library(httr)
# install.packages("knitr")
library(knitr)
# install.packages("XML")
library(XML)
#install.packages("plyr")
library(plyr)
# install.packages("Amelia")
library(Amelia)
#install.packages("XLConnect")
library(XLConnect)
# install.packages("countrycode")
library("countrycode")
# install.packages ("ggplot2")
library(ggplot2)
# # install.packages ("magrittr") ???
library(magrittr)
# install.packages ("fmsb")
library(fmsb)
# install.packages ("car")
library(car)
# install.packages("DataCombine")
library(DataCombine)
# install.packages("lmtest")
library(lmtest)
####################################################################################
########################## LOADING AND CLEANING WDI DATA ###########################
####################################################################################
# 2. Loading the default data for the years 2000-2012 from the Worldbank database
wbdata <- c('NY.GDP.MKTP.KD', 'NY.GDP.PCAP.PP.KD', 'SI.POV.GAPS', 'SP.RUR.TOTL.ZS',
'EN.ATM.CO2E.PC', 'EG.ELC.ACCS.ZS', 'SH.XPD.TOTL.ZS', 'SH.H2O.SAFE.ZS',
'SH.STA.ACSN', 'SL.UEM.TOTL.ZS','SL.TLF.0714.WK.ZS', 'SE.PRM.ENRR', 'SH.XPD.PCAP',
'SL.UEM.TOTL.FE.ZS', 'SE.PRM.ENRR.FE', 'SP.HOU.FEMA.ZS', 'SP.DYN.LE00.IN',
'SI.POV.GINI', 'SH.CON.1524.FE.ZS', 'SH.CON.1524.MA.ZS', 'SP.DYN.CONU.ZS',
'SH.IMM.IDPT', 'SH.IMM.MEAS', 'SH.STA.OWGH.ZS', 'SH.PRV.SMOK.FE',
'SH.PRV.SMOK.MA', 'SP.POP.TOTL','SH.MED.BEDS.ZS','SH.STA.BRTC.ZS')
dataset <- WDI(country='all', indicator=wbdata, start=2000, end=2012, extra=TRUE)
# 3. Cleaning the data
## Dropping regional data
dataset <- dataset[dataset$region != "Aggregates", ]
# Dropping rows where all variables are missing
dataset2 <- dataset[which(rowSums(!is.na(dataset[, wbdata])) > 0), ]
# Visualising and counting deleted values
rows.in.a1.that.are.not.in.a2  <- function(dataset,dataset2)
{
dataset.vec <- apply(dataset, 1, paste, collapse = "")
dataset2.vec <- apply(dataset2, 1, paste, collapse = "")
a1.without.a2.rows <- dataset[!dataset.vec %in% dataset2.vec,]
return(a1.without.a2.rows)
}
AllNAs <- rows.in.a1.that.are.not.in.a2(dataset,dataset2)
nrow(AllNAs)
dataset <- dataset2
# Dropping rows where information on variable iso2c is missing
dataset <- dataset[!is.na(dataset$iso2c),] ## No observations were dropped ###
## Ordering the dataset and the years (ascending)
dataset <- group_by(dataset, iso2c)
dataset <- arrange(dataset, iso2c, year)
## Renaming all the variables with simple names
dataset <- plyr::rename(dataset, c("NY.GDP.MKTP.KD" = "GDP"))
dataset <- plyr::rename(dataset, c("NY.GDP.PCAP.PP.KD" = "GDPpc"))
dataset <- plyr::rename(dataset, c("SI.POV.GAPS" = "Poverty"))
dataset <- plyr::rename(dataset, c("SP.RUR.TOTL.ZS" = "Rural"))
dataset <- plyr::rename(dataset, c("EN.ATM.CO2E.PC" = "CO2"))
dataset <- plyr::rename(dataset, c("EG.ELC.ACCS.ZS" = "Electr"))
dataset <- plyr::rename(dataset, c("SH.XPD.TOTL.ZS" = "HCexpend"))
dataset <- plyr::rename(dataset, c("SH.XPD.PCAP" = "HCexpendpc"))
dataset <- plyr::rename(dataset, c("SH.STA.BRTC.ZS" = "Births"))
dataset <- plyr::rename(dataset, c("SH.MED.BEDS.ZS" = "HospBeds"))
dataset <- plyr::rename(dataset, c("SH.H2O.SAFE.ZS" = "Water"))
dataset <- plyr::rename(dataset, c("SH.STA.ACSN" = "Sanitation"))
dataset <- plyr::rename(dataset, c("SL.UEM.TOTL.ZS" = "Unemploym"))
dataset <- plyr::rename(dataset, c("SL.TLF.0714.WK.ZS" = "Childempl"))
dataset <- plyr::rename(dataset, c("SE.PRM.ENRR" = "Primary"))
dataset <- plyr::rename(dataset, c("SL.UEM.TOTL.FE.ZS" = "FemUnempl"))
dataset <- plyr::rename(dataset, c("SE.PRM.ENRR.FE" = "FemSchool"))
dataset <- plyr::rename(dataset, c("SP.HOU.FEMA.ZS" = "FemHead"))
dataset <- plyr::rename(dataset, c("SP.DYN.LE00.IN" = "LifeExpect"))
dataset <- plyr::rename(dataset, c("SI.POV.GINI" = "GINI"))
dataset <- plyr::rename(dataset, c("SH.CON.1524.FE.ZS" = "CondFem"))
dataset <- plyr::rename(dataset, c("SH.CON.1524.MA.ZS" = "CondMale"))
dataset <- plyr::rename(dataset, c("SP.DYN.CONU.ZS" = "Contraceptive"))
dataset <- plyr::rename(dataset, c("SH.IMM.IDPT" = "DPT"))
dataset <- plyr::rename(dataset, c("SH.IMM.MEAS" = "Measles"))
dataset <- plyr::rename(dataset, c("SH.STA.OWGH.ZS" = "Overweight"))
dataset <- plyr::rename(dataset, c("SH.PRV.SMOK.FE" = "SmokeFem"))
dataset <- plyr::rename(dataset, c("SH.PRV.SMOK.MA" = "SmokeMale"))
dataset <- plyr::rename(dataset, c("SP.POP.TOTL" = "Population"))
## Counting NAs in the independent variables
AllNAs$GDPsum <- sum(is.na(dataset$GDP))/nrow(dataset)
AllNAs$GDPpcsum <- sum(is.na(dataset$GDPpc))/nrow(dataset)
AllNAs$Povertysum <- sum(is.na(dataset$Poverty))/nrow(dataset)
AllNAs$Ruralsum <- sum(is.na(dataset$Rural))/nrow(dataset)
AllNAs$CO2sum <- sum(is.na(dataset$CO2))/nrow(dataset)
AllNAs$Electrsum <- sum(is.na(dataset$Electr))/nrow(dataset)
AllNAs$HCexpendsum <- sum(is.na(dataset$HCexpend))/nrow(dataset)
AllNAs$HCexpendpcsum <- sum(is.na(dataset$HCexpendpc))/nrow(dataset)
AllNAs$Birthssum <- sum(is.na(dataset$Births))/nrow(dataset)
AllNAs$Watersum <- sum(is.na(dataset$Water))/nrow(dataset)
AllNAs$Sanitationsum <- sum(is.na(dataset$Sanitation))/nrow(dataset)
AllNAs$Unemploymsum <- sum(is.na(dataset$Unemploym))/nrow(dataset)
AllNAs$Childemplsum <- sum(is.na(dataset$Childempl))/nrow(dataset)
AllNAs$Primarysum <- sum(is.na(dataset$Primary))/nrow(dataset)
AllNAs$FemUnemplsum <- sum(is.na(dataset$FemUnempl))/nrow(dataset)
AllNAs$FemSchoolsum <- sum(is.na(dataset$FemSchool))/nrow(dataset)
AllNAs$FemHeadsum <- sum(is.na(dataset$FemHead))/nrow(dataset)
AllNAs$LifeExpectsum <- sum(is.na(dataset$LifeExpect))/nrow(dataset)
AllNAs$GINIsum <- sum(is.na(dataset$GINI))/nrow(dataset)
AllNAs$CondFemPsum <- sum(is.na(dataset$CondFem))/nrow(dataset)
AllNAs$CondMalesum <- sum(is.na(dataset$CondMale))/nrow(dataset)
AllNAs$Contraceptivesum <- sum(is.na(dataset$Contraceptive))/nrow(dataset)
AllNAs$DPTsum <- sum(is.na(dataset$DPT))/nrow(dataset)
AllNAs$Measlessum <- sum(is.na(dataset$Measles))/nrow(dataset)
AllNAs$Overweightsum <- sum(is.na(dataset$Overweight))/nrow(dataset)
AllNAs$SmokeFemsum <- sum(is.na(dataset$SmokeFem))/nrow(dataset)
AllNAs$SmokeMalesum <- sum(is.na(dataset$SmokeMale))/nrow(dataset)
AllNAs$HospBedssum <- sum(is.na(dataset$HospBeds))/nrow(dataset)
install.packages("mapCountryData")
install.packages(joinCountryData2Map)
rm(list = ls())
library("ggmap")
library("maptools")
library("countrycode")
library("RJSONIO")
library("WDI")
library("tidyr")
library("rio")
library("ggplot2")
library("rworldmap")
library("sp")
library('rworldmap')
library('Formula')
library('plm')
library('pglm')
#2. Setting directory
setwd('/Users/AnaCe/Desktop/Assignment3MontesReyla')
#setwd('/Users/ayrarowenareyla/Desktop/The Hertie School of Governance/Collaborative Social Sciences/Assignment3MontesReyla/Assignment3MontesReyla')
########################################################################################
################################# LOADING AND CLEANING DATA ############################
########################################################################################
# 4. Loading Migration UN Data
### loop that loads into R each table in the file and extracts the relevant information for this assigment
tables <-c(2, 5, 8, 11)
for (i in tables)   {
Migration<- import("UN_MigrantStockByOriginAndDestination_2013T10.xls",
format = "xls", sheet =i)
emigration<- Migration[c(15,16),]
emigration<- t(emigration)
emigration<-as.data.frame(emigration)
emigration<- emigration[c(10:241),]
colnames(emigration) <- c("Country","Emigration")
assign(paste0("emigration", i), emigration)
}
emigrationtotal <- cbind(emigration11, emigration8, emigration5, emigration2)
emigrationtotal <-emigrationtotal[,c(1,2, 4, 6,  8)]
emigrationtotal <- gather(emigrationtotal, year, emigration, 2:5)
emigrationtotal$year <- as.character(emigrationtotal$year)
emigrationtotal$year[emigrationtotal$year=="Emigration"] <- "2013"
emigrationtotal$year[emigrationtotal$year=="Emigration.1"] <- "2010"
emigrationtotal$year[emigrationtotal$year=="Emigration.2"] <- "2000"
emigrationtotal$year[emigrationtotal$year=="Emigration.3"] <- "1990"
ls()
rm(list = c("emigration","emigration11", "emigration2", "emigration5", "emigration8",
"i", "tables"))
# 5. Loading data from the Worldbank database
wbdata <- c ("IT.CEL.SETS.P2", "IT.NET.USER.P2", "NY.GDP.PCAP.PP.CD","SP.POP.TOTL","SI.POV.DDAY","SL.UEM.TOTL.ZS","VC.IHR.PSRC.P5"
,"CC.EST","GE.EST","PV.EST","RQ.EST","RL.EST","VA.EST","SP.DYN.TFRT.IN")
WDI_indi<- WDI(country = "all", indicator = wbdata,
start = 1990, end = 2013, extra = FALSE, cache = NULL)
# 6. Creating an unique identifier for both data frames
emigrationtotal$iso2c <- countrycode (emigrationtotal$Country, origin = 'country.name',
destination = 'iso2c', warn = TRUE)
WDI_indi$iso2c <- countrycode (WDI_indi$country, origin = 'country.name',
destination = 'iso2c', warn = TRUE)
# 7. Merging "WDI Indicators " and "UN Migration stocks"
Merged <- merge(emigrationtotal, WDI_indi, by = c('iso2c','year'))
summary(Merged)
# 8. Cleaning the data
Merged <- plyr::rename(Merged, c("IT.CEL.SETS.P2" = "CellphoneUsers"))
Merged <- plyr::rename(Merged, c("IT.NET.USER.P2" = "InternetUsers"))
Merged <- plyr::rename(Merged, c("NY.GDP.PCAP.PP.CD" = "GDPPerCapita"))
Merged <- plyr::rename(Merged, c("SP.POP.TOTL" = "TotalPopulation"))
Merged <- plyr::rename(Merged, c("SI.POV.DDAY" = "Poverty"))
Merged <- plyr::rename(Merged, c("SL.UEM.TOTL.ZS" = "UnemploymentRate"))
Merged <- plyr::rename(Merged, c("VC.IHR.PSRC.P5" = "IntentionalHomocides"))
Merged <- plyr::rename(Merged, c("CC.EST" = "Corruption"))
Merged <- plyr::rename(Merged, c("GE.EST" = "GovernmentEffectiveness"))
Merged <- plyr::rename(Merged, c("PV.EST" = "PoliticalStability"))
Merged <- plyr::rename(Merged, c("RQ.EST" = "RegulatoryQuality"))
Merged <- plyr::rename(Merged, c("RL.EST" = "RuleOfLaw"))
Merged <- plyr::rename(Merged, c("VA.EST" = " VoiceAndAccountability"))
Merged <- plyr::rename(Merged, c("SP.DYN.TFRT.IN" = "FertilityRate"))
# Counting missing information in the Independent Variables
variables <-c("CellphoneUsers", "InternetUsers", "GDPPerCapita", "TotalPopulation", "Poverty",
"UnemploymentRate", "IntentionalHomocides", "Corruption", "FertilityRate",
"GovernmentEffectivness", "PoliticalStability", "RegulatoryStability",
"RegulatoryQuality", "RuleOfLaw", "VoiceAndAccountability")
NAs<- sum(is.na(Merged$CellphoneUsers))/nrow(Merged)
NAs$InternetUsers<- sum(is.na(Merged$InternetUsers))/nrow(Merged)
NAs$GDPPerCapita<- sum(is.na(Merged$GDPPerCapita))/nrow(Merged)
NAs$TotalPopulation<- sum(is.na(Merged$TotalPopulation))/nrow(Merged)
NAs$Poverty<- sum(is.na(Merged$Poverty))/nrow(Merged)
NAs$UnemploymentRate<- sum(is.na(Merged$UnemploymentRate))/nrow(Merged)
NAs$Corruption<- sum(is.na(Merged$Corruption))/nrow(Merged)
NAs$IntentionalHomocides<- sum(is.na(Merged$IntentionalHomocides))/nrow(Merged)
NAs$GovernmentEffectivness<- sum(is.na(Merged$GovernmentEffectivness))/nrow(Merged)
NAs$PoliticalStability<- sum(is.na(Merged$PoliticalStability))/nrow(Merged)
NAs$RegulatoryStability<- sum(is.na(Merged$RegulatoryStability))/nrow(Merged)
NAs$VoiceAndAccountability<- sum(is.na(Merged$VoiceAndAccountability))/nrow(Merged)
NAs$FertilityRate<- sum(is.na(Merged$FertilityRate))/nrow(Merged)
# After looking at the number of missing variables in the Merged data frame.
# Also, we are dropping independent variables with more than 15% of the total observations NA
Merged <- Merged[, !(colnames(Merged)) %in% c("Poverty", "IntentionalHomocides","PoliticalStability","Corruption", "UnemploymentRate")]
# Dropping missing values
Merged <- Merged[!is.na(Merged$InternetUsers),]
Merged <- Merged[!is.na(Merged$CellphoneUsers),]
Merged <- Merged[!is.na(Merged$GDPPerCapita),]
Merged <- Merged[!is.na(Merged$FertilityRate),]
table (Merged$year)
summary(Merged)
View(Merged)
View(Merged)
View(Migration)
View(Migration)
View(WDI_indi)
View(WDI_indi)
Merged <- Merged[!is.na(WDI_indi$iso2c),]
WDI_indi <- WDI_indi[!is.na(WDI_indi$iso2c),]
Merged <- merge(emigrationtotal, WDI_indi, by = c('iso2c','year'))
summary(Merged)
# 8. Cleaning the data
Merged <- plyr::rename(Merged, c("IT.CEL.SETS.P2" = "CellphoneUsers"))
Merged <- plyr::rename(Merged, c("IT.NET.USER.P2" = "InternetUsers"))
Merged <- plyr::rename(Merged, c("NY.GDP.PCAP.PP.CD" = "GDPPerCapita"))
Merged <- plyr::rename(Merged, c("SP.POP.TOTL" = "TotalPopulation"))
Merged <- plyr::rename(Merged, c("SI.POV.DDAY" = "Poverty"))
Merged <- plyr::rename(Merged, c("SL.UEM.TOTL.ZS" = "UnemploymentRate"))
Merged <- plyr::rename(Merged, c("VC.IHR.PSRC.P5" = "IntentionalHomocides"))
Merged <- plyr::rename(Merged, c("CC.EST" = "Corruption"))
Merged <- plyr::rename(Merged, c("GE.EST" = "GovernmentEffectiveness"))
Merged <- plyr::rename(Merged, c("PV.EST" = "PoliticalStability"))
Merged <- plyr::rename(Merged, c("RQ.EST" = "RegulatoryQuality"))
Merged <- plyr::rename(Merged, c("RL.EST" = "RuleOfLaw"))
Merged <- plyr::rename(Merged, c("VA.EST" = " VoiceAndAccountability"))
Merged <- plyr::rename(Merged, c("SP.DYN.TFRT.IN" = "FertilityRate"))
# Counting missing information in the Independent Variables
variables <-c("CellphoneUsers", "InternetUsers", "GDPPerCapita", "TotalPopulation", "Poverty",
"UnemploymentRate", "IntentionalHomocides", "Corruption", "FertilityRate",
"GovernmentEffectivness", "PoliticalStability", "RegulatoryStability",
"RegulatoryQuality", "RuleOfLaw", "VoiceAndAccountability")
NAs<- sum(is.na(Merged$CellphoneUsers))/nrow(Merged)
NAs$InternetUsers<- sum(is.na(Merged$InternetUsers))/nrow(Merged)
NAs$GDPPerCapita<- sum(is.na(Merged$GDPPerCapita))/nrow(Merged)
NAs$TotalPopulation<- sum(is.na(Merged$TotalPopulation))/nrow(Merged)
NAs$Poverty<- sum(is.na(Merged$Poverty))/nrow(Merged)
NAs$UnemploymentRate<- sum(is.na(Merged$UnemploymentRate))/nrow(Merged)
NAs$Corruption<- sum(is.na(Merged$Corruption))/nrow(Merged)
NAs$IntentionalHomocides<- sum(is.na(Merged$IntentionalHomocides))/nrow(Merged)
NAs$GovernmentEffectivness<- sum(is.na(Merged$GovernmentEffectivness))/nrow(Merged)
NAs$PoliticalStability<- sum(is.na(Merged$PoliticalStability))/nrow(Merged)
NAs$RegulatoryStability<- sum(is.na(Merged$RegulatoryStability))/nrow(Merged)
NAs$VoiceAndAccountability<- sum(is.na(Merged$VoiceAndAccountability))/nrow(Merged)
NAs$FertilityRate<- sum(is.na(Merged$FertilityRate))/nrow(Merged)
# After looking at the number of missing variables in the Merged data frame.
# Also, we are dropping independent variables with more than 15% of the total observations NA
Merged <- Merged[, !(colnames(Merged)) %in% c("Poverty", "IntentionalHomocides","PoliticalStability","Corruption", "UnemploymentRate")]
# Dropping missing values
Merged <- Merged[!is.na(Merged$InternetUsers),]
Merged <- Merged[!is.na(Merged$CellphoneUsers),]
Merged <- Merged[!is.na(Merged$GDPPerCapita),]
Merged <- Merged[!is.na(Merged$FertilityRate),]
# Check Variables structure
str(Merged)
summary(Merged)
table (Merged$year)
Merged$year <- as.numeric(Merged$year)
Merged$emigration <- as.numeric(Merged$emigration)
str(Merged)
Merged <-subset.data.frame(Merged, select = -Country)
# 9. Generating variables
Merged$emigration2 = Merged$emigration/1000
Merged$emigrationpercap = Merged$emigration/Merged$TotalPopulation
# sub dataframes by year
merged90 <-subset(Merged, year==1990)
merged00 <-subset(Merged, year==2000)
merged10 <-subset(Merged, year==2010)
merged13 <-subset(Merged, year==2013)
# Creating a .csv file with the final version of the data
write.csv(Merged, file="MontesandReyla")
###############################################################################################
############################### DESCRIPTIVE STATISTICS ##############################
####################################################################################
# Mapping global emigration
# 1990
sPDF <- joinCountryData2Map( merged90
,joinCode = "ISO2"
,nameJoinColumn = "iso2c")
mapDevice(Map1)
mapCountryData(sPDF, nameColumnToPlot='emigrationpercap', mapTitle= 'Number of emigrants per capita 1990',
colourPalette = c("darkorange", "coral2","gold","aquamarine1", "cyan3", "blue","magenta"),
borderCol='black')
View(emigrationtotal)
View(emigrationtotal)
View(WDI_indi)
View(WDI_indi)
sPDFII <- joinCountryData2Map( merged00
,joinCode = "ISO2"
,nameJoinColumn = "iso2c")
mapDevice(Map2)
mapCountryData(sPDFII, nameColumnToPlot='emigrationpercap', mapTitle= 'Number of emigrants per capita 2000',
colourPalette = c("darkorange", "coral2","gold","aquamarine1", "cyan3", "blue","magenta"),
borderCol='black')
# 2010
?mapCountryData
mapCountryData(sPDF, nameColumnToPlot='emigrationpercap', mapTitle= 'Number of emigrants per capita 1990',
colourPalette = c("darkorange", "coral2","gold","aquamarine1", "cyan3", "blue","magenta"),
borderCol='black', oceanCol = TRUE)
mapCountryData(sPDF, nameColumnToPlot='emigrationpercap', mapTitle= 'Number of emigrants per capita 1990',
colourPalette = c("darkorange", "coral2","gold","aquamarine1", "cyan3", "blue","magenta"),
borderCol='black', oceanCol = "blue"")
mapCountryData(sPDF, nameColumnToPlot='emigrationpercap', mapTitle= 'Number of emigrants per capita 1990',
colourPalette = c("darkorange", "coral2","gold","aquamarine1", "cyan3", "blue","magenta"),
borderCol='black', oceanCol = "blue")
mapCountryData(sPDF, nameColumnToPlot='emigrationpercap', mapTitle= 'Number of emigrants per capita 1990',
colourPalette = c("darkorange", "coral2","gold","aquamarine1", "cyan3", "blue","magenta"),
borderCol='black', oceanCol = 'blue')
mapCountryData(sPDF, nameColumnToPlot='emigrationpercap', mapTitle= 'Number of emigrants per capita 1990',
colourPalette = c("darkorange", "coral2","gold","aquamarine1", "cyan3", "blue","magenta"),
borderCol='black', oceanCol = 'azure')
cor.test(Merged$emigrationpercap, Merged$InternetUsers)
cor.test(Merged$emigrationpercap, Merged$CellphoneUsers)
plot(emigration2 ~ InternetUsers, data = merged13,
xlab = "E", las = 1,
ylab = "C",
main = "Emigration data and fitted curve")
plot(emigrationpercap ~ InternetUsers, data = merged13,
xlab = "E", las = 1,
ylab = "C",
main = "Emigration data and fitted curve")
cor.test(Merged$emigration, Merged$InternetUsers)
cor.test(Merged$emigrationpercap, Merged$InternetUsers)
plot(emigrationper2 ~ year, data = Merged,
xlab = "E", las = 1,
ylab = "C",
main = "Emigration data and fitted curve")
plot(emigrationper ~ year, data = Merged,
xlab = "E", las = 1,
ylab = "C",
main = "Emigration data and fitted curve")
plot(emigrationpercap ~ year, data = Merged,
xlab = "E", las = 1,
ylab = "C",
main = "Emigration data and fitted curve")
plot(emigration ~ year, data = Merged,
xlab = "E", las = 1,
ylab = "C",
main = "Emigration data and fitted curve")
plot(emigration ~ InternetUsers, data = merged13,
xlab = "E", las = 1,
ylab = "C",
main = "Emigration data and fitted curve")
plot(emigration ~ GDPPerCapita, data = merged13,
xlab = "E", las = 1,
ylab = "C",
main = "Emigration data and fitted curve")
plot(emigrationpercap ~ GDPPerCapita, data = merged13,
xlab = "E", las = 1,
ylab = "C",
main = "Emigration data and fitted curve")
sd(Merged$CellphoneUsers)
sd(Merged$InternetUsers)
sd(Merged$emigration2)
range(Merged$emigration)
